<div class="wrapper">
  <% include ../../../common/nav.ejs %>
  <!-- mode 변수 할당 -->
  <section id="page-title" class="page-title" style="padding: 150px 0;">
    <div class="container clearfix"><h1>글쓰기</h1></div>
  </section>
  <!-- Content -->
  <!--
    넘겨주는 값 (/submit)
    title: 제목
    writer: 사용자 ID
    contents: 에디터 내용
    upFile: 업로드 파일 있을시 업로드 (TODO)
    subject: 카테고리 과목설정
    important: 0 - 일반글, 1 - 공지글
    mode: 'add': 글 작성, 'edit': 글 수정 'delete': 글 삭제
  -->
  <section id="content">
    <div class="content-wrap">
      <form id="posting" method="POST" action="/board/submit">
        <div id="importContainer">
          <span id="notice">공지</span>
          <!-- Checkbox Unchecked: 0, Checked: 1 -->
          <input
            id="important"
            type="checkbox"
            name="important"
            onclick="checkbox()"
          />
        </div>
        <div class="form-row">
          <div class="col-sm-3">
            <select id="subject" class="form-control" name="subject">
              <option value="" selected>--카테고리--</option>
              <option value="0">일반</option>
              <option value="1">운영체제</option>
              <option value="2">웹 프로그래밍</option>
              <option value="3">Advanced OS</option>
              <option value="4">종합설계</option>
            </select>
          </div>
          <div class="col-sm-9">
            <input
              type="text"
              id="title"
              class="form-control"
              name="title"
              placeholder="제목을 입력해주세요"
            />
          </div>
        </div>
        <input type="hidden" id="writer" name="writer" value="admin" /> <% if
        (mode == 'add') { %> <input type="hidden" name="mode" value="add" /> <%
        } else if (mode == 'edit') { %>
        <input type="hidden" name="mode" value="edit" /> <% } %>
        <textarea name="contents" style="display: none;"></textarea>
      </form>
      <div id="summernote"></div>
      <form>
        <div class="form-group">
          <label for="exampleFormControlFile1">Example file input</label>
          <input type="file" class="form-control-file" />
        </div>
      </form>
      <button
        id="edit"
        class="btn btn-primary save"
        type="button"
        style="display: none;"
      >
        Save
      </button>
      <button id="save" class="btn btn-primary save" type="button">Save</button>
    </div>
    <% include ../../../common/footer.ejs %>
  </section>
</div>
<script>
  $(document).ready(function() {
    $('#summernote').summernote({
      lang: 'ko-KR',
      focus: true,
      minHeight: 450,
      maxHeight: 780,
      placeholder: '내용을 입력해주세요',
      shortcuts: false,
      toolbar: [
        ['style', ['bold', 'italic', 'underline']],
        ['fontsize', ['fontsize']],
        ['forecolor', ['forecolor']],
        ['color', ['color']],
        ['para', ['ul', 'ol', 'paragraph']],
        ['insert', ['picture', 'link', 'video', 'table']],
        ['Misc', ['codeview', 'undo', 'redo']],
      ],
    });
  });
</script>
<!-- edit mode -->
<% if (mode == 'edit') { %>
<script>
  function editMode() {
    if ('<%- content.important %>' == 1) $('#important').val(1);
    switch (<%- content.subject %>) {
      case 0:
        $('#subject').val(0).select;
        break;
      case 1:
        $('#subject').val(1).select;
        break;
      case 2:
        $('#subject').val(2).select;
        break;
      case 3:
        $('#subject').val(3).select;
        break;
      case 4:
        $('#subject').val(4).select;
        break;
      case 5:
        $('#subject').val(5).select;
        break;
    }
    $('#title').val('<%- content.title %>');
    $('#writer').val('<%- content.writer %>');
    $('#summernote').summernote('code', '<%- content.contents %>', );
  }
</script>
<%} %>
<script>
  /* save 눌렀을 때 */
  function checkbox() {
    if ($('#important').is(':checked')) $('#important').val(1);
    else $('#important').val(0);
  }
  /* edit Mode */
  const mode = '<%- mode %>';
  if (mode == 'edit') {
    console.log('edit mode');
    $('#edit').css('display', 'block');
    $('#save').css('display', 'none');
    editMode();
  }
</script>
